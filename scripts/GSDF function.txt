##Define source file path and target gene

setwd("C:")
target_gene <- "STAT3"

##call libraries
library(readxl)
library(survival)
library(tidyverse)

#import files

DMGs <- read.csv("DMGs.txt")
DEIMR <- read_table("DEIMR.txt")
DEGs <- read.csv("DEGs.txt")
miRNA <- read_excel("miRNA.xlsx")
target_miRNA  <- read.csv("microrna_target.txt", sep="")
expression <- read_excel("expression.xlsx")
methylation <- read_excel("methylation.xlsx")

#

miRNA<- miRNA%>%
  rename(p.value.miRNA=c(2), log.FC.miRNA=c(3))
methylation<- methylation%>%
  rename(p.value.cpg=c(3), logFC.cpg=c(4))

##Differential profile
x <-  any(DEGs ==target_gene)
if (x==TRUE){
  DEG <- "yes"
} else {
  DEG <-"no"
}

y <-  any(DMGs ==target_gene)
if (y==TRUE){
  DMG <-  "yes"
} else {
  DMG <- "no"
}
#miRNA
MR_G<-merge(target_miRNA,DEIMR, by.x = "miRNA", by.y = "miRNA")
z <-  any(MR_G ==target_gene)
if (z==TRUE){
  DEIMR_G <- "yes"
} else {
  DEIMR_G <-"no"
}

## GSDF
#expression
gene_expression <- filter(expression, str_starts(gene,target_gene))
gene_expression=select(gene_expression,-1)
if (nrow(gene_expression)==0){
  gene_expression <- "no data"
  gene_expression<-data.frame(gene_expression)
}

#methylation
cpg_methylation <- filter(methylation, str_starts(gene,target_gene))
cpg_methylation=select(cpg_methylation,-1)
if (nrow(cpg_methylation)==0){
  cpg_methylation <- "no data"
  cpg_methylation<-data.frame(cpg_methylation)
}

#miRNA
mir_gene <- target_miRNA  %>%
  filter(gene==target_gene)
miRNA_expression<-merge(mir_gene,miRNA, by.x = "miRNA", by.y = "miRNA_ID")
miRNA_expression=select(miRNA_expression,-2)

if (nrow(miRNA_expression)==0){
  miRNA_expression <- "no data"
  miRNA_expression <- data.frame(miRNA_expression)
}

#Result
result <- data.frame(target_gene,DEG,DMG,DEIMR_G)
GSD<-bind_rows(result,gene_expression,cpg_methylation,miRNA_expression)
GSD
#Export result
write.table(GSD, "Gene_Specific_Data.txt", sep = ",")



